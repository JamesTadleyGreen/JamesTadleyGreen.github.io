<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Day II: Cube Conundrum - James Green</title>
        <link rel="stylesheet" href="../../css/variables.css" />
        <link rel="stylesheet" href="../../css/default.css" />
        <link rel="stylesheet" href="../../css/syntax.css" />
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../../">James Tadley Green</a>
            </div>
            <nav>
                <a href="../../">Home</a>
                <a href="../../about.html">About</a>
                <a href="../../posts.html">Posts</a>
            </nav>
        </header>

        <main role="main">
            <h1 class="title">Day II: Cube Conundrum</h1>
            <section class="header">
    <ol class="post-info">
        
            <li>
                Last updated 2024-06-17 <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 10h16m-8-3V4M7 7V4m10 3V4M5 20h14c.6 0 1-.4 1-1V7c0-.6-.4-1-1-1H5a1 1 0 0 0-1 1v12c0 .6.4 1 1 1Zm3-7h0v0h0v0Zm4 0h0v0h0v0Zm4 0h0v0h0v0Zm-8 4h0v0h0v0Zm4 0h0v0h0v0Zm4 0h0v0h0v0Z"></path>
</svg>

            </li>
            <li>
                19 minute read <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path>
</svg>

            </li>
            <li>
                74b540b <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm8-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 0a4 4 0 0 1-4 4h-1a3 3 0 0 0-3 3"></path>
</svg>

            </li>
            <li>
               #<a class="tag" href="../../tags/AOC.html">AOC</a> #<a class="tag" href="../../tags/haskell.html">haskell</a> <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.6 8.4h0m-4.7 11.3-6.6-6.6a1 1 0 0 1 0-1.4l7.3-7.4a1 1 0 0 1 .7-.3H18a2 2 0 0 1 2 2v5.5a1 1 0 0 1-.3.7l-7.5 7.5a1 1 0 0 1-1.3 0Z"></path>
</svg>

            </li>
        
    </ol>
</section>

            <link rel="stylesheet" href="../../css/toc.css" />
<table class="toc">
    <tbody>
    
        
            <tr>
                <td><a href="../../posts/advent_of_code_2023/1-day-1.html">1</a></td>
                <td><a href="../../posts/advent_of_code_2023/1-day-1.html">Day I: Trebuchet?!</a></td>
            </tr>
        
    
        
            <tr class="active-row">
                <td><a href="../../posts/advent_of_code_2023/2-day-2.html">2</a></td>
                <td><a href="../../posts/advent_of_code_2023/2-day-2.html">Day II: Cube Conundrum</a></td>
            </tr>
        
    
        
            <tr>
                <td><a href="../../posts/advent_of_code_2023/3-day-3.html">3</a></td>
                <td><a href="../../posts/advent_of_code_2023/3-day-3.html">Day III: Gear Ratios</a></td>
            </tr>
        
    
    </tbody>
</table>

<link rel="stylesheet" href="../../css/post.css" />
<link rel="stylesheet" href="../../css/JetBrains-Mono.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
<!-- The loading of KaTeX is deferred to speed up page rendering -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>

<!-- To automatically render math in text elements, include the auto-render extension: -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<article>
    <!-- <section class="header">
    <ol class="post-info">
        
            <li>
                Last updated 2024-06-17 <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 10h16m-8-3V4M7 7V4m10 3V4M5 20h14c.6 0 1-.4 1-1V7c0-.6-.4-1-1-1H5a1 1 0 0 0-1 1v12c0 .6.4 1 1 1Zm3-7h0v0h0v0Zm4 0h0v0h0v0Zm4 0h0v0h0v0Zm-8 4h0v0h0v0Zm4 0h0v0h0v0Zm4 0h0v0h0v0Z"/>
</svg>

            </li>
            <li>
                16 minute read <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
</svg>

            </li>
            <li>
                74b540b <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm8-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 0a4 4 0 0 1-4 4h-1a3 3 0 0 0-3 3"/>
</svg>

            </li>
            <li>
               #<a class="tag" href="/tags/AOC.html">AOC</a> #<a class="tag" href="/tags/haskell.html">haskell</a> <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.6 8.4h0m-4.7 11.3-6.6-6.6a1 1 0 0 1 0-1.4l7.3-7.4a1 1 0 0 1 .7-.3H18a2 2 0 0 1 2 2v5.5a1 1 0 0 1-.3.7l-7.5 7.5a1 1 0 0 1-1.3 0Z"/>
</svg>

            </li>
        
    </ol>
</section>
 -->
    <section>
        <h1 data-number="1" id="cube-conundrum"><span class="header-section-number">1</span> <a href="https://adventofcode.com/2023/day/2">Cube Conundrum</a></h1>
<p>This was easier than yesterday! Since this is an easier problem, let’s focus on
datatypes. The question talks about games and colours, so let’s define what these
look like.</p>
<div class="sourceCode" id="cb1" data-startFrom="17"><pre class="sourceCode numberSource numberLines haskell"><code class="sourceCode haskell" style="counter-reset: source-line 16;"><span id="cb1-17"><a href="#cb1-17"></a><span class="kw">data</span> <span class="dt">Colour</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>  <span class="ot">=</span> <span class="dt">Blue</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>  <span class="op">|</span> <span class="dt">Green</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>  <span class="op">|</span> <span class="dt">Red</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>  <span class="kw">deriving</span> (<span class="dt">Show</span>, <span class="dt">Eq</span>)</span>
<span id="cb1-22"><a href="#cb1-22"></a></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="kw">data</span> <span class="dt">Game</span> <span class="ot">=</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>  <span class="dt">Game</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>    {<span class="ot"> game_id ::</span> <span class="dt">Int</span></span>
<span id="cb1-26"><a href="#cb1-26"></a>    ,<span class="ot"> games ::</span> [[(<span class="dt">Int</span>, <span class="dt">Colour</span>)]]</span>
<span id="cb1-27"><a href="#cb1-27"></a>    }</span>
<span id="cb1-28"><a href="#cb1-28"></a>  <span class="kw">deriving</span> (<span class="dt">Show</span>)</span></code></pre></div>
<h1 data-number="2" id="part-i"><span class="header-section-number">2</span> Part I</h1>
<h2 data-number="2.1" id="question"><span class="header-section-number">2.1</span> Question</h2>
<p>As the datatypes above alluded to, we have some records of games, in the format:</p>
<pre><code>Game 1: 3 blue, 4 red; 1 red, 2 green, 6 blue; 2 green
Game 2: 1 blue, 2 green; 3 green, 4 blue, 1 red; 1 green, 1 blue
Game 3: 8 green, 6 blue, 20 red; 5 blue, 4 red, 13 green; 5 green, 1 red
Game 4: 1 green, 3 red, 6 blue; 3 green, 6 red; 3 green, 15 blue, 14 red
Game 5: 6 red, 1 blue, 3 green; 2 blue, 1 red, 2 green</code></pre>
<p>The question is simple, given the restriction of 12 red, 13 green, and 14 blue cubes,
how many of the above are valid games?</p>
<h2 data-number="2.2" id="my-solution"><span class="header-section-number">2.2</span> My Solution</h2>
<p>The first job is to parse the input into our data types.</p>
<div class="sourceCode" id="cb3" data-startFrom="32"><pre class="sourceCode numberSource numberLines haskell"><code class="sourceCode haskell" style="counter-reset: source-line 31;"><span id="cb3-32"><a href="#cb3-32"></a><span class="ot">parseInput ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> [<span class="dt">Game</span>]</span>
<span id="cb3-33"><a href="#cb3-33"></a>parseInput <span class="ot">=</span> <span class="fu">map</span> makeGame <span class="op">.</span> <span class="fu">lines</span></span>
<span id="cb3-34"><a href="#cb3-34"></a></span>
<span id="cb3-35"><a href="#cb3-35"></a><span class="ot">makeGame ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Game</span></span>
<span id="cb3-36"><a href="#cb3-36"></a>makeGame line <span class="ot">=</span> <span class="dt">Game</span> {game_id <span class="ot">=</span> i, games <span class="ot">=</span> extractAttempts gs}</span>
<span id="cb3-37"><a href="#cb3-37"></a>  <span class="kw">where</span></span>
<span id="cb3-38"><a href="#cb3-38"></a>    [a, gs] <span class="ot">=</span> splitOn <span class="st">&quot;: &quot;</span> line</span>
<span id="cb3-39"><a href="#cb3-39"></a>    i <span class="ot">=</span> <span class="fu">read</span> <span class="op">$</span> <span class="fu">last</span> (splitOn <span class="st">&quot; &quot;</span> a)<span class="ot"> ::</span> <span class="dt">Int</span></span>
<span id="cb3-40"><a href="#cb3-40"></a></span>
<span id="cb3-41"><a href="#cb3-41"></a><span class="ot">extractAttempts ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> [[(<span class="dt">Int</span>, <span class="dt">Colour</span>)]]</span>
<span id="cb3-42"><a href="#cb3-42"></a>extractAttempts line <span class="ot">=</span> <span class="fu">map</span> extractGames (splitOn <span class="st">&quot;; &quot;</span> line)</span>
<span id="cb3-43"><a href="#cb3-43"></a></span>
<span id="cb3-44"><a href="#cb3-44"></a><span class="ot">extractGames ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> [(<span class="dt">Int</span>, <span class="dt">Colour</span>)]</span>
<span id="cb3-45"><a href="#cb3-45"></a>extractGames attempts <span class="ot">=</span> <span class="fu">map</span> extractGame (splitOn <span class="st">&quot;, &quot;</span> attempts)</span>
<span id="cb3-46"><a href="#cb3-46"></a></span>
<span id="cb3-47"><a href="#cb3-47"></a><span class="ot">extractGame ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> (<span class="dt">Int</span>, <span class="dt">Colour</span>)</span>
<span id="cb3-48"><a href="#cb3-48"></a>extractGame <span class="ot">=</span> (\[a, b] <span class="ot">-&gt;</span> (<span class="fu">read</span> a, readColour b)) <span class="op">.</span> splitOn <span class="st">&quot; &quot;</span></span>
<span id="cb3-49"><a href="#cb3-49"></a></span>
<span id="cb3-50"><a href="#cb3-50"></a><span class="ot">readColour ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Colour</span></span>
<span id="cb3-51"><a href="#cb3-51"></a>readColour <span class="st">&quot;blue&quot;</span> <span class="ot">=</span> <span class="dt">Blue</span></span>
<span id="cb3-52"><a href="#cb3-52"></a>readColour <span class="st">&quot;green&quot;</span> <span class="ot">=</span> <span class="dt">Green</span></span>
<span id="cb3-53"><a href="#cb3-53"></a>readColour <span class="st">&quot;red&quot;</span> <span class="ot">=</span> <span class="dt">Red</span></span></code></pre></div>
<p>The above is mainly housekeeping and nothing clever happens.</p>
<div class="sourceCode" id="cb4" data-startFrom="57"><pre class="sourceCode numberSource numberLines haskell"><code class="sourceCode haskell" style="counter-reset: source-line 56;"><span id="cb4-57"><a href="#cb4-57"></a><span class="ot">part1 ::</span> [<span class="dt">Game</span>] <span class="ot">-&gt;</span> <span class="dt">Maybe</span> <span class="dt">Int</span></span>
<span id="cb4-58"><a href="#cb4-58"></a>part1 gs <span class="ot">=</span> <span class="dt">Just</span> <span class="op">$</span> part1' gs</span>
<span id="cb4-59"><a href="#cb4-59"></a></span>
<span id="cb4-60"><a href="#cb4-60"></a><span class="ot">part1' ::</span> [<span class="dt">Game</span>] <span class="ot">-&gt;</span> <span class="dt">Int</span></span>
<span id="cb4-61"><a href="#cb4-61"></a>part1' <span class="ot">=</span></span>
<span id="cb4-62"><a href="#cb4-62"></a>  <span class="fu">foldr</span></span>
<span id="cb4-63"><a href="#cb4-63"></a>    ((\(i, b) acc <span class="ot">-&gt;</span></span>
<span id="cb4-64"><a href="#cb4-64"></a>        <span class="kw">if</span> b</span>
<span id="cb4-65"><a href="#cb4-65"></a>          <span class="kw">then</span> i <span class="op">+</span> acc</span>
<span id="cb4-66"><a href="#cb4-66"></a>          <span class="kw">else</span> acc) <span class="op">.</span></span>
<span id="cb4-67"><a href="#cb4-67"></a>     validGames)</span>
<span id="cb4-68"><a href="#cb4-68"></a>    <span class="dv">0</span></span>
<span id="cb4-69"><a href="#cb4-69"></a></span>
<span id="cb4-70"><a href="#cb4-70"></a><span class="ot">validGames ::</span> <span class="dt">Game</span> <span class="ot">-&gt;</span> (<span class="dt">Int</span>, <span class="dt">Bool</span>)</span>
<span id="cb4-71"><a href="#cb4-71"></a>validGames (<span class="dt">Game</span> {game_id <span class="ot">=</span> i, games <span class="ot">=</span> gs}) <span class="ot">=</span> (i, validGame gs)</span>
<span id="cb4-72"><a href="#cb4-72"></a></span>
<span id="cb4-73"><a href="#cb4-73"></a><span class="ot">validGame ::</span> [[(<span class="dt">Int</span>, <span class="dt">Colour</span>)]] <span class="ot">-&gt;</span> <span class="dt">Bool</span></span>
<span id="cb4-74"><a href="#cb4-74"></a>validGame <span class="ot">=</span> <span class="fu">foldr</span> ((<span class="op">&amp;&amp;</span>) <span class="op">.</span> validGame') <span class="dt">True</span></span>
<span id="cb4-75"><a href="#cb4-75"></a></span>
<span id="cb4-76"><a href="#cb4-76"></a><span class="ot">validGame' ::</span> [(<span class="dt">Int</span>, <span class="dt">Colour</span>)] <span class="ot">-&gt;</span> <span class="dt">Bool</span></span>
<span id="cb4-77"><a href="#cb4-77"></a>validGame' [] <span class="ot">=</span> <span class="dt">True</span></span>
<span id="cb4-78"><a href="#cb4-78"></a>validGame' ((i, <span class="dt">Blue</span>)<span class="op">:</span>gs) <span class="ot">=</span> i <span class="op">&lt;=</span> <span class="dv">14</span> <span class="op">&amp;&amp;</span> validGame' gs</span>
<span id="cb4-79"><a href="#cb4-79"></a>validGame' ((i, <span class="dt">Green</span>)<span class="op">:</span>gs) <span class="ot">=</span> i <span class="op">&lt;=</span> <span class="dv">13</span> <span class="op">&amp;&amp;</span> validGame' gs</span>
<span id="cb4-80"><a href="#cb4-80"></a>validGame' ((i, <span class="dt">Red</span>)<span class="op">:</span>gs) <span class="ot">=</span> i <span class="op">&lt;=</span> <span class="dv">12</span> <span class="op">&amp;&amp;</span> validGame' gs</span></code></pre></div>
<p>I inititally wrote this with folds, but in retrospect, I think the below approach of
recursion is prettier and easier to read.</p>
<div class="sourceCode" id="cb5" data-startFrom="84"><pre class="sourceCode numberSource numberLines haskell"><code class="sourceCode haskell" style="counter-reset: source-line 83;"><span id="cb5-84"><a href="#cb5-84"></a><span class="ot">part1b ::</span> [<span class="dt">Game</span>] <span class="ot">-&gt;</span> <span class="dt">Int</span></span>
<span id="cb5-85"><a href="#cb5-85"></a>part1b [] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb5-86"><a href="#cb5-86"></a>part1b (g<span class="op">:</span>gs) <span class="ot">=</span> validGames' g <span class="op">+</span> part1b gs</span>
<span id="cb5-87"><a href="#cb5-87"></a></span>
<span id="cb5-88"><a href="#cb5-88"></a><span class="ot">validGames' ::</span> <span class="dt">Game</span> <span class="ot">-&gt;</span> <span class="dt">Int</span></span>
<span id="cb5-89"><a href="#cb5-89"></a>validGames' (<span class="dt">Game</span> {game_id <span class="ot">=</span> i, games <span class="ot">=</span> gs}) <span class="ot">=</span></span>
<span id="cb5-90"><a href="#cb5-90"></a>  <span class="kw">if</span> validGame gs</span>
<span id="cb5-91"><a href="#cb5-91"></a>    <span class="kw">then</span> i</span>
<span id="cb5-92"><a href="#cb5-92"></a>    <span class="kw">else</span> <span class="dv">0</span></span></code></pre></div>
<p>Moving the checking logic to the <code>validGames'</code> function makes much more sense, it also
simplifies the data we’re passing around.</p>
<h1 data-number="3" id="part-ii"><span class="header-section-number">3</span> Part II</h1>
<h2 data-number="3.1" id="question-1"><span class="header-section-number">3.1</span> Question</h2>
<p>We slightly complicate the problem, instead of a fixed limit, we want to calculate what
the minimum possible constraint we can add to each set of games.</p>
<h2 data-number="3.2" id="my-solution-1"><span class="header-section-number">3.2</span> My Solution</h2>
<p>This time we fold over in exactly the same way, calculating the product of the tuple,
taking the maximum at each step. Annoying, to get pairwise maximum we have to write a
custom function, since, if we used the built in max, this is lexicographical ordering.</p>
<div class="sourceCode" id="cb6" data-startFrom="95"><pre class="sourceCode numberSource numberLines haskell"><code class="sourceCode haskell" style="counter-reset: source-line 94;"><span id="cb6-95"><a href="#cb6-95"></a><span class="ot">part2 ::</span> [<span class="dt">Game</span>] <span class="ot">-&gt;</span> <span class="dt">Maybe</span> <span class="dt">Int</span></span>
<span id="cb6-96"><a href="#cb6-96"></a>part2 games <span class="ot">=</span> <span class="dt">Just</span> <span class="op">$</span> <span class="fu">foldr</span> ((<span class="op">+</span>) <span class="op">.</span> calculatePower <span class="op">.</span> minCubes) <span class="dv">0</span> games</span>
<span id="cb6-97"><a href="#cb6-97"></a></span>
<span id="cb6-98"><a href="#cb6-98"></a><span class="ot">calculatePower ::</span> (<span class="dt">Int</span>, <span class="dt">Int</span>, <span class="dt">Int</span>) <span class="ot">-&gt;</span> <span class="dt">Int</span></span>
<span id="cb6-99"><a href="#cb6-99"></a>calculatePower (a, b, c) <span class="ot">=</span> a <span class="op">*</span> b <span class="op">*</span> c</span>
<span id="cb6-100"><a href="#cb6-100"></a></span>
<span id="cb6-101"><a href="#cb6-101"></a><span class="ot">minCubes ::</span> <span class="dt">Game</span> <span class="ot">-&gt;</span> (<span class="dt">Int</span>, <span class="dt">Int</span>, <span class="dt">Int</span>)</span>
<span id="cb6-102"><a href="#cb6-102"></a>minCubes <span class="dt">Game</span> {game_id <span class="ot">=</span> _, games <span class="ot">=</span> games} <span class="ot">=</span> <span class="fu">foldr</span> minAttempt (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>) games</span>
<span id="cb6-103"><a href="#cb6-103"></a></span>
<span id="cb6-104"><a href="#cb6-104"></a><span class="ot">minAttempt ::</span> [(<span class="dt">Int</span>, <span class="dt">Colour</span>)] <span class="ot">-&gt;</span> (<span class="dt">Int</span>, <span class="dt">Int</span>, <span class="dt">Int</span>) <span class="ot">-&gt;</span> (<span class="dt">Int</span>, <span class="dt">Int</span>, <span class="dt">Int</span>)</span>
<span id="cb6-105"><a href="#cb6-105"></a>minAttempt gs t <span class="ot">=</span> <span class="fu">foldr</span> minAttempt' t gs</span>
<span id="cb6-106"><a href="#cb6-106"></a></span>
<span id="cb6-107"><a href="#cb6-107"></a><span class="ot">minAttempt' ::</span> (<span class="dt">Int</span>, <span class="dt">Colour</span>) <span class="ot">-&gt;</span> (<span class="dt">Int</span>, <span class="dt">Int</span>, <span class="dt">Int</span>) <span class="ot">-&gt;</span> (<span class="dt">Int</span>, <span class="dt">Int</span>, <span class="dt">Int</span>)</span>
<span id="cb6-108"><a href="#cb6-108"></a>minAttempt' (i, <span class="dt">Red</span>) (r, g, b) <span class="ot">=</span> (<span class="fu">max</span> r i, g, b)</span>
<span id="cb6-109"><a href="#cb6-109"></a>minAttempt' (i, <span class="dt">Green</span>) (r, g, b) <span class="ot">=</span> (r, <span class="fu">max</span> g i, b)</span>
<span id="cb6-110"><a href="#cb6-110"></a>minAttempt' (i, <span class="dt">Blue</span>) (r, g, b) <span class="ot">=</span> (r, g, <span class="fu">max</span> b i)</span>
<span id="cb6-111"><a href="#cb6-111"></a></span>
<span id="cb6-112"><a href="#cb6-112"></a>a <span class="ot">=</span> <span class="dt">Just</span> <span class="dv">1</span></span>
<span id="cb6-113"><a href="#cb6-113"></a>b <span class="ot">=</span> <span class="dt">Just</span> <span class="dv">2</span></span>
<span id="cb6-114"><a href="#cb6-114"></a></span>
<span id="cb6-115"><a href="#cb6-115"></a>y <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb6-116"><a href="#cb6-116"></a>    x <span class="ot">&lt;-</span> a</span>
<span id="cb6-117"><a href="#cb6-117"></a>    x <span class="op">&lt;$</span> b</span>
<span id="cb6-118"><a href="#cb6-118"></a></span>
<span id="cb6-119"><a href="#cb6-119"></a>z <span class="ot">=</span> b <span class="op">&gt;&gt;</span> a</span></code></pre></div>
<h1 data-number="4" id="others-solutions"><span class="header-section-number">4</span> Others Solutions</h1>
<p>Looking at <a href="https://topaz.github.io/paste/#XQAAAQB6CgAAAAAAAAA2m8ixrhLu7WoI0BF4zkDp9jvUlcRHHvK3yKnG3P2kZ0VVAnVdxkqaaMuXbCDS2sUmeACmsqQV5sx1lUFUqxyA41kr3M2cyJLoDN5h9Qj1pgdNxrb6qHR7ztT9mF2TsvW3SiSo80gXLGt1MtjZlwKmIubb5Grf5moHMsy3xxji1KVu7dHt5riywlAzC+C8/LeeQVhaAmMoHlB35obNubL2cVbCtQBuKwL9QXfNUteVR3SRN4/9l3ybV95Bs/1cVPHq4I2A5ZLml6AqcLYBqYw8HFL/fSkIH7W96J5thynJSHR1GaGSApt4u7hstJ9Pcer6wJwBM5xD/VETvFEW5wewOX8f4d/vjI1yXkG8ghIccCBCDn0nb02eHs1rbCEPU8Gw7FkEku9jrk02lcztD4tZgTIia0RzFjaQzSynpoJadSWtcWnrtaNlrD604utNgKoRAj/stYutotEFSp2LNho2xxCAbUWIm/cRZKkNru7B8IrNJ/rJXGY5pb2Xc9mHhdvi6TcxRSDN6bg/cpA13MZ8/mjkaaYmnIt9tfpn4REBvXvI/bV1hbeuTsv2gX56bUL8NiyGHzgFTrcap/B85LkAvAUFH+snkQDwB6PFyuOvwPhv5rxWNwe68CEZNYV6bjNZ8FxgZdGTZOgM5puDraFlC0zsr8V5ZsutBM2XDEfuL54lZ3AAOroQnah7wMgAgFM0S7cxoXVINi7xhfu0KaKMQIQ3OfcK1c5SDQU635Ig4dntBqD2fGYNAMohXa59qCVxkMLxepJxjCqvfHLJJB9yZ/6SO06Oy9gREjuhmhiL8prov115/emHowzoBgWb1985KlpLbSdCIHB1DWVTR63X9m8rrl9b4KQZCzvgFU9T4lTROtgF2NEpwAD3v1/Wrh1jcquQ21R9IvVJRod5Te2zrV0Asc80HKtHyuuAd5EM0K9zMWgFkuLtWYMpaF0XUGFpPYniYLd4kXARgh6U0fQq+0m+rVuKy3ixaqPCyc6A1CVpAupDEfgr2FxgkMdRWZMwFHL+JoQIHqE2Py8h6TRoHMMVWcvMj+wmE7J4wXwkvp7DhCrax24Tx62Lzah06fJWvoO3N13K7hNNN4Gov8mIAT6n56Bn1Q6Hb6aXoYoFvkOCweJLd06Ht1ow6iPjdyerYX+XVLDOZjAVlq1398QY9T5ObObT05E1a5xCu9iCkKpcLVGBFavCsFTnmhnZx2//1v7bEw==">this</a>
solution, it turns out there are significantly more ‘user friendly’ ways of parsing data
in Haskell.</p>
<p>The key takeaway is the below:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ot">parseGame ::</span> <span class="dt">Parser</span> <span class="dt">Game</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>parseGame <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  string <span class="st">&quot;Game &quot;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">id</span> <span class="ot">&lt;-</span> decimal</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  char <span class="ch">':'</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  gameShows <span class="ot">&lt;-</span> parseGameShow <span class="ot">`sepBy`</span> char <span class="ch">';'</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">id</span>, gameShows)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="ot">parseGameShow ::</span> <span class="dt">Parser</span> <span class="dt">GameShow</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>parseGameShow <span class="ot">=</span> parseCubeCount <span class="ot">`sepBy`</span> (char <span class="ch">','</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="ot">parseCubeCount ::</span> <span class="dt">Parser</span> <span class="dt">CubeCount</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>parseCubeCount <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  skipSpace</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">&lt;-</span> decimal</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  space</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  choice [<span class="dt">Blue</span> count <span class="op">&lt;$</span> string <span class="st">&quot;blue&quot;</span>, <span class="dt">Red</span> count <span class="op">&lt;$</span> string <span class="st">&quot;red&quot;</span>, <span class="dt">Green</span> count <span class="op">&lt;$</span> string <span class="st">&quot;green&quot;</span>]</span></code></pre></div>
<p>The they’re using <a href="https://hackage.haskell.org/package/attoparsec">Attoparsec</a> for
parsing, and the <code>do</code>-notation is definitely cleaner than my approach.
A new function that I hadn’t seen before is <code>&lt;$</code>, which has type
<code>Functor f =&gt; a -&gt; f b -&gt; f a</code>. At first glace this appears pointless, we discard <code>b</code>?
The use in this case is to simply ‘recognise’ the structure and discard the result. Thus,
we ‘recognise’ and ignore <code>"blue"</code>, only caring about taking <code>Blue count</code>.
This has a lot of similarities to <code>&gt;&gt; :: Monad m =&gt; m a -&gt; m b -&gt; m b</code>.
The below are equal.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> a</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x <span class="op">&lt;$</span> b</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> b <span class="op">&gt;&gt;</span> a</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>z <span class="op">==</span> y</span></code></pre></div>
<p>The rest of their solution is pretty similar to mine, with the exception of utilising
the <code>all</code> operator.</p>
    </section>
</article>


        </main>

        <footer>
            © 2023, James Green
        </footer>
    </body>
</html>
